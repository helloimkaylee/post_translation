

###__스택[Stack]__ 
![type](http://i.msdn.microsoft.com/dynimg/IC379050.png)

1. 값 형식의 인스턴스는 메모리의 스택에 할당되고 
참조형식은 힙에 할당
ex) struct, enum

2. 형식은 null값을 가질 수 없다.
하지만 nullable 형식을 이용해 값 형식에 null을 대입할 수는 있다.
반대로 참조형식은 null은 가능하고, nullable은 사용할 수 없다.
값 형식 변수의 경우 별도의 힙 할당이나 가비지 수집 오버헤드가 없다.

###__힙[Heap]__ 
1. 참조형식은 참조값을 힙에 저장하기때문에, .net framework를 통해서 관리가 된다. 그리고 참조 형식에 값을 대입하면 참조 형식에 값이 대입되는 것이 아니라 참조 형식의 복사본 을 만들게 됩니다.

2. class, delegate 또는 interfase로 정의된 형식은 참조 형식입니다.

3. 참조형식의 변수를 선언한 경우 new 연산자를 사용하여 개체의 인스턴스를 명명시적으로 만들어서 다른곳에서 만들어진 개체를 변수에 할당할 때까지 해당 변수는 런타임에 null값을 가지게 된다.

4. 개체를 생성하면 관리되는 힙에 메모리가 할당되고 변수는 개체 위치에 대한 참조만 유지합니다. 

5. 참조형식의 기본값은 null(nothing)입니다.

6. 힙은 객체를 할당하여 사용하지 않을때 제거 될 수 있으며,
스택은 블록 ({}) 범위에서 메모리가 할당과 해제가 됩니다.

![stack and heap](http://cfile223.uf.daum.net/image/2161603D511DDE6A0B086A)

만약 객체생성을 하지 않는다면 오류!
구조체는 변수 선언이 곧 객체 생성이며 모든 멤버 변수 초기화 후 사용 할 수 있습니다.
![객체생성안했을때](http://cfile222.uf.daum.net/image/13267540511DDE7A10CF2F)


###__박싱[Boxing & Unboxing]__  

![boxing unboxing](http://www.codeproject.com/KB/dotnet/6importentStepsDotNet/13.jpg)

###__개체 핸들__ 


###__mark and sweep 가비지 컬렉션__
먼저 가비지 컬렉션이란?
1. 가비지 컬렉션
응용 프로그램의 메모리 할당 및 해제를 관리합니다.
사용자가 새 개체를 만들 때마다 런타임에서는 관리되는 힙에서 해당개체에 메모리를 할당하며 관리되는 힙에 주소 공간이 남아 있으면 새 개체에 필요한 공간을 계속하여 할당합니다.

2. Mark & Sweep

![Mark Sweep](http://morwalz.com/wp-content/uploads/2013/04/mark-and-sweep-alog-300x157.png)

3. 표시하고 쓸기 기법은 포인터 추적 기법 가운데 가장 단순한 기법이다. 먼저 각 메모리 할당 영역에 표시를 위해 1 비트의 메모리를 남겨 둔다. 표시 단계에서, 모든 변수가 가리키는 영역을 "사용 중"으로 표시하고, 그 영역에서 가리키는 또다른 영역 또한 "사용 중"으로 표시한다. 이와 같이 모든 메모리 영역을 표시하고 나면, 표시되지 않은 영역을 접근 불가능한 메모리 영역이 된다. 접근 불가능한 메모리 영역들을 쓸기 단계에서 모두 해제한다.

4. 이 기법의 단점은, 표시 단계에서 메모리 내용이 변경되지 않아야 하기 때문에 전체 시스템의 실행이 정지된다는 것이다. (garbage collection 하는 중에, 유효하다고 체크되지는 않았지만 실제로는 유효한 객체에 대한 참조를 다른 쓰레드가 메모리에서 옮기고 다닐 수 있기 때문에 그 객체는 garbage로 간주될 수 있기 때문이다)
5. 또한 전체 메모리 영역을 검사해야 하므로 메모리 페이징을 사용하는 운영체제에서 프로그램의 성능이 저하될 수 있다.



###__약한 참조[Weak Reference]__

!]
1. 가비지 수집기는 응용 프로그램에서 사용하고 있는 개체를 수집할 수 없으며 응용 프로그램의 코드에서는 해당 개체에 액세스 할 수 있습니다. 이 응용 프로그램을 가리켜 개체에 대한 강한 참조를 갖고 있다고 합니다.

2. 방법 : 개체에 대한 약한 참조를 설정하려면 추적할 개체의 인스턴스를 사용하여 WeakReference를 만듭니다. 그런 다음 Target속성을 해당 개체로 설정하고 해당 개체 참조를 null로 설정합니다. 

```
Man m = new Man();
    WeakReference refMan = new WeakReference(m); //약한참조
    m = null;
    GC.Collect();
    
```

